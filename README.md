# –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ú–û. –î–≤–æ–π–Ω–æ–π —Å–ø—É—Å–∫. –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–µ–Ω–æ–º–µ–Ω–∞ –¥–≤–æ–π–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –≤ –≥–ª—É–±–æ–∫–æ–º –æ–±—É—á–µ–Ω–∏–∏ –ø–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º —Å—Ç–∞—Ç—å–∏ Grokking: Generalization beyond overfitting (—Å–º. –Ω–∏–∂–µ —Ç–æ—á–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ).
–ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–∞–≥–∞–µ—Ç—Å—è –æ–±–∑–æ—Ä–Ω–∞—è —Å—Ç–∞—Ç—å—è (–æ—á–µ—Ä–∫ <ins>Intuitive Learning, Paper.pdf</ins>), –≥–¥–µ –∏—Å—Å–ª–µ–¥—É–µ—Ç—Å—è —Å–≤—è–∑—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è —Å –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ–º –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö. 
–ó–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ–º—ã:
- –°–≤—è–∑—å –Ω–æ—Ä–º—ã, –≥–ª–∞–¥–∫–æ—Å—Ç–∏, —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ—Å—Ç–æ—Ç—ã —Ä–µ—à–µ–Ω–∏—è. –ü—Ä–∏–Ω—Ü–∏–ø "–±—Ä–∏—Ç–≤—ã –û–∫–∫–∞–º–∞".
- flat minima, generalization gap
- epoch-wise DD (–¥–≤–æ–π–Ω–æ–π —Å–ø—É—Å–∫ –ø–æ —ç–ø–æ—Ö–∞–º)

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤–æ–π–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ (30 000 –∏—Ç–µ—Ä–∞—Ü–∏–π, batchsize=512, budget=3e5):
| –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å            | –¢–æ—á–Ω–æ—Å—Ç—å          |
|------------------------|------------------------|
| ![](results/loss.png) | ![](results/acc.png) |

## –ö–ª—é—á–µ–≤–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è
–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –∫—Ä–∏–≤–æ–π –¥–≤–æ–π–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ epoch-wise –º–æ–¥–µ–ª–∏ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–µ ùëÜùê∫ùê∑. –°–æ–≥–ª–∞—Å–Ω–æ –µ–π –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç—Ä–∏ —ç—Ç–∞–ø–∞:
1. –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ (simple generalisation)
–ú–æ–¥–µ–ª—å –∏–∑—É—á–∞–µ—Ç –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏. Test Error ‚Üì
2. –ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (memorizing)
–ï—Å–ª–∏ —à—É–º–∞ –Ω–µ—Ç, —Ç–æ –º–æ–¥–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö, –∑–∞–ø–æ–º–∏–Ω–∞—è –∏—Ö –∏ –ø—ã—Ç–∞—è—Å—å –≤—Å—Ç—Ä–æ–∏—Ç—å –∫ —É–∂–µ –∏–∑—É—á–µ–Ω–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∫ —Ç–æ–º—É –∂–µ –∑–∞—à—É–º–ª–µ–Ω—ã,
—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Ç–∞–∫–∂–µ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è. Train Error ‚Üì; Test Error ‚Üë
4. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (consolidation)
–ú–æ–¥–µ–ª—å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —É—Å–ø–µ—à–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–∞–ø–æ–≤ (1) –∏ (2), –ø—É—Ç–µ–º —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –∏ —É–ø—Ä–æ—â–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ Test Error ‚Üì, –¥–≤–æ–π–Ω–æ–π —Å–ø—É—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω.

## –ó–∞–ø—É—Å–∫
```python
train.py # –° –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏
```
## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

(1) –û–ø–µ—Ä–∞—Ü–∏—è $\frac{x}{y} \ mod \ p \ $, $(x + y) \ mod \ p \$, $x \cdot y \ mod \ p \$

(2) –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –≤ –≥—Ä—É–ø–ø–µ $S_{97}$: $xyx^{-1}, \ x \cdot y$

| –ù–æ–º–µ—Ä –æ–ø—ã—Ç–∞ | Batch size | Budget | –í–∏–¥ –æ–ø–µ—Ä–∞—Ü–∏–∏
|:-----------:|:-----------:|:-----------:|:-----------:|
| 1   |         512  |        3e5 | (1) | 
| 2   |         256  |         3e4    | (1) |
| 3   |         256  |         3e4 | (2) |

### –û–ø—ã—Ç 1
| –¢–æ—á–Ω–æ—Å—Ç—å | –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å |
|----------|----------|
| <img src="results/acc_512.gif" alt="" width="535" height="400"> | <img src="results/loss_512.gif" alt="" width="535" height="400"> |

### –û–ø—ã—Ç 2

| –¢–æ—á–Ω–æ—Å—Ç—å | –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å |
|----------|----------|
| <img src="results/acc_256.gif" alt="" width="535" height="400"> | <img src="results/loss_256.gif" alt="" width="535" height="400"> |

### –û–ø—ã—Ç 3

<img src="results/Perm_loss_100.png" alt="" width="640" height="480">

## –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
```
@inproceedings{power2021grokking,
  title={Grokking: Generalization beyond overfitting on small algorithmic datasets},
  author={Power, Alethea and Burda, Yuri and Edwards, Harri and Babuschkin, Igor and Misra, Vedant},
  booktitle={ICLR MATH-AI Workshop},
  year={2021}
}
```
